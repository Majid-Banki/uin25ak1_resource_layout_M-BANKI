<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tabbed Interface</title>
    <link rel="stylesheet" href="/css/style.css" />
    <script type="module">
      import { resources } from "./ressurs.js"

      document.addEventListener("DOMContentLoaded", () => {
        const tabsContainer = document.querySelector("nav")
        const contentContainer = document.querySelector("section")

        // Create Tabs using map()
        function createTabs() {
          const uniqueCategories = [
            ...new Set(resources.map((res) => res.category)),
          ] // Extract unique categories

          uniqueCategories.map((category, index) => {
            const tab = document.createElement("button")
            tab.classList.add("tab")
            tab.textContent = category
            tab.dataset.tab = category.toLowerCase().replace(/\s+/g, "-")

            if (index === 0) tab.classList.add("active") // Default active tab

            tabsContainer.appendChild(tab)
          })
        }

        // Create Content based on selected category using filter()
        function createContent(selectedCategory) {
          contentContainer.innerHTML = "" // Clear previous content

          const filteredResources = resources.filter(
            (resource) => resource.category === selectedCategory
          )

          filteredResources.map((resource) => {
            const article = document.createElement("article")
            article.classList.add("active") // Display active content

            const heading = document.createElement("h2")
            heading.textContent = resource.category

            const paragraph = document.createElement("p")
            paragraph.textContent = resource.text

            const list = document.createElement("ul")

            resource.sources.map((source) => {
              const listItem = document.createElement("li")
              const link = document.createElement("a")
              link.href = source.url
              link.textContent = source.title
              link.target = "_blank"
              listItem.appendChild(link)
              list.appendChild(listItem)
            })

            article.appendChild(heading)
            article.appendChild(paragraph)
            article.appendChild(list)

            contentContainer.appendChild(article)
          })
        }

        // Tab switching using map & filter
        function setupTabSwitching() {
          const tabs = document.querySelectorAll(".tab")

          tabs.forEach((tab) => {
            tab.addEventListener("click", () => {
              tabs.forEach((t) => t.classList.remove("active")) // Remove active class from all tabs
              tab.classList.add("active") // Set clicked tab as active

              const selectedCategory = tab.textContent // Get category name
              createContent(selectedCategory) // Update content
            })
          })
        }

        createTabs()
        createContent(resources[0].category) // Load first category by default
        setupTabSwitching()
      })
    </script>
  </head>
  <body>
    <main>
      <nav></nav>
      <section></section>
    </main>
  </body>
</html>
